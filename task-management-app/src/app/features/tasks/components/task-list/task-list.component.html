<p>task-list works!</p>
<div class="task-list-container">
  <!-- Page header -->
  <app-page-header
    [title]="'Tasks'"
    [subtitle]="'Manage your tasks'">
    <button
      mat-raised-button
      color="primary"
      (click)="createTask()">
      <mat-icon>add</mat-icon>
      Create Task
    </button>
  </app-page-header>

  <!-- Filter section -->
  <app-task-filter></app-task-filter>

  <!-- Task table card -->
  <mat-card class="table-card">
    <!-- Toolbar -->
    <div class="table-toolbar">
      <!-- Search -->
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search tasks</mat-label>
        <input
          matInput
          #searchInput
          (keyup)="applySearch(searchInput.value)"
          placeholder="Search by title or description">
        <mat-icon matPrefix>search</mat-icon>
      </mat-form-field>

      <!-- Spacer -->
      <span class="spacer"></span>

      <!-- Refresh button -->
      <button
        mat-icon-button
        (click)="refreshTasks()"
        matTooltip="Refresh">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>

    <!-- Loading spinner -->
    <app-loading-spinner
      *ngIf="loading"
      [message]="'Loading tasks...'">
    </app-loading-spinner>

    <!-- Task table -->
    <div class="table-container" *ngIf="!loading">
      <table
        mat-table
        [dataSource]="dataSource"
        matSort
        class="tasks-table">

        <!-- Title Column -->
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Title</th>
          <td mat-cell *matCellDef="let task">
            <div class="task-title">
              <span
                class="title-text"
                [class.overdue]="isOverdue(task)">
                {{ task.title }}
              </span>
              <mat-icon
                *ngIf="isOverdue(task)"
                class="overdue-icon"
                matTooltip="Overdue">
                warning
              </mat-icon>
            </div>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
          <td mat-cell *matCellDef="let task">
            <span
              class="status-badge"
              [ngClass]="task.status | statusColor: 'status'">
              {{ formatStatus(task.status) }}
            </span>
          </td>
        </ng-container>

        <!-- Priority Column -->
        <ng-container matColumnDef="priority">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Priority</th>
          <td mat-cell *matCellDef="let task">
            <span
              class="priority-badge"
              [ngClass]="task.priority | statusColor: 'priority'">
              {{ task.priority }}
            </span>
          </td>
        </ng-container>

        <!-- Assigned To Column -->
        <ng-container matColumnDef="assignedTo">
          <th mat-header-cell *matHeaderCellDef>Assigned To</th>
          <td mat-cell *matCellDef="let task">
            <span *ngIf="task.assignedTo">User {{ task.assignedTo }}</span>
            <span *ngIf="!task.assignedTo" class="unassigned">Unassigned</span>
          </td>
        </ng-container>

        <!-- Due Date Column -->
        <ng-container matColumnDef="dueDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Due Date</th>
          <td mat-cell *matCellDef="let task">
            <span *ngIf="task.dueDate">
              {{ task.dueDate | date: 'MMM dd, yyyy' }}
            </span>
            <span *ngIf="!task.dueDate" class="no-date">-</span>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let task">
            <button
              mat-icon-button
              [matMenuTriggerFor]="menu"
              aria-label="Task actions">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item (click)="viewTask(task)">
                <mat-icon>visibility</mat-icon>
                <span>View</span>
              </button>
              <button mat-menu-item (click)="editTask(task)">
                <mat-icon>edit</mat-icon>
                <span>Edit</span>
              </button>
              <button mat-menu-item (click)="deleteTask(task)">
                <mat-icon color="warn">delete</mat-icon>
                <span>Delete</span>
              </button>
            </mat-menu>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns;"
          class="task-row"
          (click)="viewTask(row)">
        </tr>

        <!-- No data row -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell no-data" [attr.colspan]="displayedColumns.length">
            <div class="no-data-container">
              <mat-icon>inbox</mat-icon>
              <p>No tasks found</p>
            </div>
          </td>
        </tr>
      </table>

      <!-- Paginator -->
      <mat-paginator
        [pageSizeOptions]="[5, 10, 25, 50]"
        [pageSize]="10"
        showFirstLastButtons>
      </mat-paginator>
    </div>
  </mat-card>
</div>
